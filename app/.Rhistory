curve(dbeta,shape1=63,shape2=39)
curve(dbeta(shape1=63,shape2=39))
curve(dbeta(x,shape1=63,shape2=39))
curve(dbeta(x,shape1=63,shape2=39),main="Beta(1+62,1+100-62",ylab="density")
curve(dbeta(x,shape1=63,shape2=39),main="Beta(1+62,1+100-62)",ylab="density")
?dbeta
curve(dbeta(x,shape1=2,shape2=8)
curve(dbeta(x,shape1=2,shape2=8)
curve(dbeta(x,shape1=2,shape2=8))
curve(dbeta(x,shape1=2,shape2=8),main="p(theta)",xlab="density")
curve(dbeta(x,shape1=2,shape2=8),main="p(theta)",ylab="density")
pr<-sapply(theta,pry,y=15,n=43)
plot(theta,pr,main="p(y|theta)",ylab="density")
plot(theta,pr,main="p(y|theta)",ylab="density",type="l")
curve(dbeta(x,shape1=17,shape2=36),main="p(theta|y",ylab="density")
curve(dbeta(x,shape1=2,shape2=8),main="p(theta)",ylab="density")
pr<-sapply(theta,pry,y=15,n=43)
plot(theta,pr,main="p(y|theta)",ylab="density",type="l")
curve(dbeta(x,shape1=17,shape2=36),main="p(theta|y)",ylab="density")
curve(dbeta(x,shape1=2,shape2=8),main="p(theta)",ylab="density")
pr<-sapply(theta,pry,y=15,n=43)
plot(theta,pr,main="p(y|theta)",ylab="density",type="l")
curve(dbeta(x,shape1=17,shape2=36),main="p(theta|y)",ylab="density")
mean<-17/53
mean # posterior mean
mode<-16/51
mode #posterior mode
sd<-sqrt(17*36/54/53/53)
sd # posterior standard deviation
mean(1-mean)/54
(mean(1-mean)/54)^(1/2.0)
17*36/54/53/53
(mean*(1-mean)/54)^(1/2.0)
?qbeta
mean<-17/53
mean # posterior mean
mode<-16/51
mode #posterior mode
sd<-sqrt(17*36/54/53/53)
sd # posterior standard deviation
l<- qbeta(0.025,17,36)#lower bound of CI
r<- qbeta(0.975,17,36)#upper bound of CI
c(l,r)
mean*(1-mean)/54
sqrt(0.004034651)
mean<-23/53
mean # posterior mean
mode<-22/51
mode #posterior mode
sd<-sqrt(23*30/54/53/53)
sd # posterior standard deviation
l<- qbeta(0.025,23,30)#lower bound of CI
r<- qbeta(0.975,23,30)#upper bound of CI
c(l,r) # 95% confidence interval
sqrt(mean*(1-mean)/54)
theta
prior<-0.75 *dbeta(theta,2,8)+0.25*dbeta(8,2)
prior<-0.75 *dbeta(theta,2,8)+0.25*dbeta(theta,8,2)
plot(theta,prior,main="prior distribution",ylab="density")
prior<-0.75 *dbeta(theta,2,8)+0.25*dbeta(theta,8,2)
plot(theta,prior,main="prior distribution",ylab="density",type="l")
gamma(10)
gamma(4)
choose(4,3)
post<-1/4*gamma(10)/gamma(2)/gamma(8)*choose(43,15)*(3*theta^16*(1-theta)^35+theta^22*(1-theta)^29)
post
plot(theta,post)
post<(3*theta^16*(1-theta)^35+theta^22*(1-theta)^29)
post<-(3*theta^16*(1-theta)^35+theta^22*(1-theta)^29)
plot(theta,post)
post<--1/4*gamma(10)/gamma(2)/gamma(8)*choose(43,15)*(3*theta^16*(1-theta)^35+theta^22*(1-theta)^29)
plot(theta,post)
post<-1/4*gamma(10)/gamma(2)/gamma(8)*choose(43,15)*(3*theta^16*(1-theta)^35+theta^22*(1-theta)^29)
plot(theta,post)
p<-0.75 *dbeta(theta,17,36)+0.25*dbeta(theta,23,30)
plot(theta,p)
p<-0.75 *dbeta(theta,17,36)+0.25*dbeta(theta,23,30)
plot(theta,p)
post<-1/4*gamma(10)/gamma(2)/gamma(8)*choose(43,15)*(3*theta^16*(1-theta)^35+theta^22*(1-theta)^29)
plot(theta,post)
p<-0.75 *dbeta(theta,17,36)+0.25*dbeta(theta,23,30)
plot(theta,p)
which.max(post)
plot(theta,post,main="p(theta)*p(y|theta)",ylab="density")
which.max(post)
theta[which.max(post)]
7/8
0.3137*0.75+0.25*0.4314
ya<-c(12,9,12,14,13,13,15,8,15,6)
yb<-c(11,11,10,8,8,8,7,10,6,8,8,9,7)
length(ya)
length(yb)
sum(ya)
sum(yb)
?qgamma
mean<-237/20
mean
var<-237/20/20
var
l<-qgamma(0.025,shape=237,rate=20)
r<-qgamma(0.975,shape=237,rate=20)
c(l,r) #95% confidence interval
111+12
mean<-123/14
mean
var<-123/14/14
var
l<-qgamma(0.025,shape=123,rate=14)
r<-qgamma(0.975,shape=123,rate=14)
c(l,r) #95% confidence interval
mean<-123/14
mean
var<-123/14/14
var
l<-qgamma(0.025,shape=123,rate=14)
r<-qgamma(0.975,shape=123,rate=14)
c(l,r) #95% confidence interval
n0<-seq(1,50,by=1)
n0
ya<-c(12,9,12,14,13,13,15,8,15,6)
yb<-c(11,11,10,8,8,8,7,10,6,8,8,9,7)
sum(ya)
sum(yb)
n0<-seq(1,50,by=1)
postmean<-(12*n0+111)/(n0+13)
postmean
n0<-seq(1,50,by=1)
postmean<-(12*n0+111)/(n0+13)
plot(n0,postmean)
n0<-seq(1,50,by=1)
postmean<-(12*n0+111)/(n0+13)
plot(n0,postmean,type="l",main="posterior expectation under prior gamma(12n0,n0)",ylab="posterior expectation")
?abline
n0<-seq(1,50,by=1)
postmean<-(12*n0+111)/(n0+13)
plot(n0,postmean,type="l",main="posterior expectation under prior gamma(12n0,n0)",ylab="posterior expectation")
abline(h=11.85)
n0<-seq(1,50,by=1)
postmean<-(12*n0+111)/(n0+13)
plot(n0,postmean,type="l",main="posterior expectation under prior gamma(12n0,n0)",ylab="posterior expectation")
abline(h=11.85)
posterior
postmean
mean<-237/20
mean
var<-237/20/20
var
l<-qgamma(0.025,shape=237,rate=20)
r<-qgamma(0.975,shape=237,rate=20)
c(l,r) #95% confidence interval
shiny::runApp('Study/ads/pj2/tripadvisor')
install.packages("CRAN")
setwd("/Users/xiaoxi/Documents/GitHub/Spring2019-Proj2-grp8/test/tripadvisor")
setwd("/Users/xiaoxi/Documents/GitHub/Spring2019-Proj2-grp8/app")
museum<-read.csv("../data/MUSEUM.csv")
head(museum)
museum$the_geom
museum<-read.csv("../data/MUSEUM.csv",as.is=T)
museum$the_geom
museum$the_geom<-substr(museum$the_geom,start=7,stop=nchar(museum$the_geom)-1)
museum$the_geom
museum<-read.csv("../data/MUSEUM.csv",as.is=T)
museum$the_geom<-substr(museum$the_geom,start=8,stop=nchar(museum$the_geom)-1)
museum$the_geom
t<-museum$the_geom<
s<-split(m)
t<-museum$the_geom
s<-split(t)
s<-strsplit(t)
s<-strsplit(t,split=" ")
s
s<-as.data.frame(strsplit(t,split=" "))
s
s<- data.frame(strsplit(t,split=" "))
s
s<- spply(t,strsplit(t,split=" "))
s<- sapply(t,strsplit(t,split=" "))
s<- sapply(t,strsplit,split=" ")
s
i=1
runApp('~/Documents/GitHub/Fall2017-project2-grp6/app')
st<-strsplit(ll[i],split=" ")
ll<-museum$the_geom
LAT<-c()
LON<-c()
n<-nrow(museum)
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,st[1])
LON<-c(LON,st[2])
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,st[1])
LON<-c(LON,st[2])
}
LAT
i=1
st<-strsplit(ll[i],split=" ")
st
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,st[[1]][1])
LON<-c(LON,st[[1]][2])
}
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,st[[1]][1])
LON<-c(LON,st[[1]][2])
}
LAT
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][1]))
LON<-c(LON,as.numeric(st[[1]][2]))
}
LAT
i=1
st<-strsplit(ll[i],split=" ")
as.numeric(st[[1]][1])
LAT<-c()
LON<-c()
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][1]))
LON<-c(LON,as.numeric(st[[1]][2]))
i=3
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][1]))
LON<-c(LON,as.numeric(st[[1]][2]))
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][1]))
LON<-c(LON,as.numeric(st[[1]][2]))
}
museum$LAT<-LAT
museum$LON<-LON
museum<-read.csv("../data/MUSEUM.csv",as.is=T)
museum$the_geom<-substr(museum$the_geom,start=8,stop=nchar(museum$the_geom)-1)
n<-nrow(museum)
ll<-museum$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][1]))
LON<-c(LON,as.numeric(st[[1]][2]))
}
museum$LAT<-LAT
museum$LON<-LON
library(dplyr)
museum<-museum$>$select(LAT,LON)
museum<-museum%>%
select(LAT,LON)
museum<-read.csv("../data/MUSEUM.csv",as.is=T)
museum$the_geom<-substr(museum$the_geom,start=8,stop=nchar(museum$the_geom)-1)
n<-nrow(museum)
ll<-museum$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][1]))
LON<-c(LON,as.numeric(st[[1]][2]))
}
museum$LAT<-LAT
museum$LON<-LON
head(museum)
museum<-museum%>%
select(NAME,TEL,URL,ADDRESS=ADDRESS1,LAT,LON)
museum<-museum%>%
select(NAME,TEL,URL,ADDRESS=ADRESS1,LAT,LON)
musem
museum
head(museum)
museum<-read.csv("../data/MUSEUM.csv",as.is=T)
museum$the_geom<-substr(museum$the_geom,start=8,stop=nchar(museum$the_geom)-1)
n<-nrow(museum)
ll<-museum$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][1]))
LON<-c(LON,as.numeric(st[[1]][2]))
}
museum$LAT<-LAT
museum$LON<-LON
museum<-museum%>%
select(NAME,TEL,URL,ADDRESS=ADRESS1,LAT,LON)
write_csv(museum, "../output/Museum.csv")
library(tidyverse)
write_csv(museum, "../output/Museum.csv")
runApp('~/Study/ads/pj2/example')
runApp('~/Study/ads/pj2/tripadvisor')
museum<-read.csv("../data/MUSEUM.csv",as.is=T)
museum$the_geom<-substr(museum$the_geom,start=8,stop=nchar(museum$the_geom)-1)
n<-nrow(museum)
ll<-museum$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][2]))
LON<-c(LON,as.numeric(st[[1]][1]))
}
museum$LAT<-LAT
museum$LON<-LON
museum<-museum%>%
select(NAME,TEL,URL,ADDRESS=ADRESS1,LAT,LON)
write_csv(museum, "../output/Museum.csv")
runApp('~/Study/ads/pj2/tripadvisor')
#theater data
theater-read.csv("../data/DOITT_THEATER_01_13SEPT2010.csv",as.is=T)
#theater data
theater<-read.csv("../data/DOITT_THEATER_01_13SEPT2010.csv",as.is=T)
#theater data
theater<-read.csv("../data/DOITT_THEATER_01_13SEPT2010.csv",as.is=T)
theaterthe_geom<-substr(theater$the_geom,start=8,stop=nchar(museum$the_geom)-1)
theaterthe_geom<-substr(theater$the_geom,start=8,stop=nchar(theater$the_geom)-1)
theater%>%head
#theater data
theater<-read.csv("../data/DOITT_THEATER_01_13SEPT2010.csv",as.is=T)
theater$the_geom<-substr(theater$the_geom,start=8,stop=nchar(theater$the_geom)-1)
theater%>%head
n<-nrow(theater)
ll<-theater$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][2]))
LON<-c(LON,as.numeric(st[[1]][1]))
}
theater$LAT<-LAT
theater$LON<-LON
theater%>%head
theater<-read.csv("../data/DOITT_THEATER_01_13SEPT2010.csv",as.is=T)
theater$the_geom<-substr(theater$the_geom,start=8,stop=nchar(theater$the_geom)-1)
n<-nrow(theater)
ll<-theater$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][2]))
LON<-c(LON,as.numeric(st[[1]][1]))
}
theater$LAT<-LAT
theater$LON<-LON
theater<-theater%>%
select(NAME,TEL,URL,ADDRESS=ADDRESS1,ZIP,LON,LAT)
write_csv(theater, "../output/Theater.csv")
#library data
library<-read.csv("../data/LIBRARY.csv",as.is=T)
head(library)
library$the_geom<-substr(library$the_geom,start=8,stop=nchar(theater$the_geom)-1)
library$the_geom<-substr(library$the_geom,start=8,stop=nchar(library$the_geom)-1)
head(library)
#library data
library<-read.csv("../data/LIBRARY.csv",as.is=T)
library$the_geom<-substr(library$the_geom,start=8,stop=nchar(library$the_geom)-1)
n<-nrow(library)
ll<-library$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][2]))
LON<-c(LON,as.numeric(st[[1]][1]))
}
library$LAT<-LAT
library$LON<-LON
head(library)
library$ADDRESS<-paste(library$HOUSENUM,library$STREETNAME)
library%>%head()
write_csv(library, "../output/Library.csv")
#museum data
museum<-read.csv("../data/MUSEUM.csv",as.is=T)
museum$the_geom<-substr(museum$the_geom,start=8,stop=nchar(museum$the_geom)-1)
n<-nrow(museum)
ll<-museum$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][2]))
LON<-c(LON,as.numeric(st[[1]][1]))
}
museum$LAT<-LAT
museum$LON<-LON
museum<-museum%>%
select(NAME,TEL,URL,ADDRESS=ADRESS1,LAT,LON)
write_csv(museum, "../output/Museum.csv")
#theater data
theater<-read.csv("../data/DOITT_THEATER_01_13SEPT2010.csv",as.is=T)
theater$the_geom<-substr(theater$the_geom,start=8,stop=nchar(theater$the_geom)-1)
n<-nrow(theater)
ll<-theater$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][2]))
LON<-c(LON,as.numeric(st[[1]][1]))
}
theater$LAT<-LAT
theater$LON<-LON
theater<-theater%>%
select(NAME,TEL,URL,ADDRESS=ADDRESS1,ZIP,LON,LAT)
write_csv(theater, "../output/Theater.csv")
#library data
library<-read.csv("../data/LIBRARY.csv",as.is=T)
library$the_geom<-substr(library$the_geom,start=8,stop=nchar(library$the_geom)-1)
n<-nrow(library)
ll<-library$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][2]))
LON<-c(LON,as.numeric(st[[1]][1]))
}
library$LAT<-LAT
library$LON<-LON
library$ADDRESS<-paste(library$HOUSENUM,library$STREETNAME)
library<-library%>%
select(NAME,ZIP,URL,LON,LAT,ADDRESS)
write_csv(library, "../output/Library.csv")
#gallery data
gallery<-read.csv("../data/ART_GALLERY.csv",as.is=T)
gallery$the_geom<-substr(gallery$the_geom,start=8,stop=nchar(gallery$the_geom)-1)
n<-nrow(gallery)
ll<-gallery$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][2]))
LON<-c(LON,as.numeric(st[[1]][1]))
}
gallery$LAT<-LAT
gallery$LON<-LON
head(gallery)
gallery$the_geom<-substr(gallery$the_geom,start=8,stop=nchar(gallery$the_geom)-1)
n<-nrow(gallery)
ll<-gallery$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][2]))
LON<-c(LON,as.numeric(st[[1]][1]))
}
gallery$LAT<-LAT
gallery$LON<-LON
gallery<-gallery%>%
select(NAME,TEL,URL,ADDRESS=ADDRESS1,ZIP,LAT,LON)
write_csv(gallery, "../output/Gallery.csv")
gallery<-read.csv("../data/ART_GALLERY.csv",as.is=T)
gallery$the_geom<-substr(gallery$the_geom,start=8,stop=nchar(gallery$the_geom)-1)
n<-nrow(gallery)
ll<-gallery$the_geom
LAT<-c()
LON<-c()
for(i in 1:n){
st<-strsplit(ll[i],split=" ")
LAT<-c(LAT,as.numeric(st[[1]][2]))
LON<-c(LON,as.numeric(st[[1]][1]))
}
gallery$LAT<-LAT
gallery$LON<-LON
gallery<-gallery%>%
select(NAME,TEL,URL,ADDRESS=ADDRESS1,ZIP,LAT,LON)
write_csv(gallery, "../output/Gallery.csv")
museum<-na.omit(read.csv("../output/museums.csv"))
getwd
getwd()
museum<-na.omit(read.csv("../output/Museum.csv"))
museum[,1:3]
restaurant<- read.csv('../output/restaurant_new.csv')
type <- unique(as.character(restaurant$TYPE))
namedata<-c("Museum","Theater","Gallery","Library")
Gallery<-na.omit(read.csv("../output/Gallery.csv",header=T))
Library<-na.omit(read.csv("../output/Library.csv",header=T))
Museum<-na.omit(read.csv("../output/Museum.csv",header=T))
Restaurant<-na.omit(read.csv("../output/Restaurant.csv",header=T))
restaurant<- read.csv('../output/restaurant_new.csv')
type <- unique(as.character(restaurant$TYPE))
namedata<-c("Museum","Theater","Gallery","Library")
Gallery<-na.omit(read.csv("../output/Gallery.csv",header=T))
Library<-na.omit(read.csv("../output/Library.csv",header=T))
Museum<-na.omit(read.csv("../output/Museum.csv",header=T))
Restaurant<-na.omit(read.csv("../output/Restaurant.csv",header=T))
Restaurant$URL<-"Unavailable"
Theater<-na.omit(read.csv("../output/Theater.csv",header=T))
all_data<-list(Gallery=Gallery,Library=Library,Museum=Museum,Restaurant=Restaurant,Theater=Theater)
register_google("AIzaSyA8OuCvy04PC3N-K9y6DdEc32hUpNyUrl8")
library(geosphere)
library(ggmap)
shiny::runApp()
install.packages("shinyjs")
runApp()
install.packages("shinyBs")
install.packages("shinyBS")
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
